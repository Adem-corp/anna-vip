let $=jQuery.noConflict();function slideUp(e,t=400){e.style.height=e.offsetHeight+"px",e.style.boxSizing="border-box",e.style.overflow="hidden",requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.style.transition=`height ${t}ms ease`,e.style.height=0})}),setTimeout(()=>{e.style.display="none",e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition")},t)}function slideDown(e,t=400){e.style.removeProperty("display");let n=getComputedStyle(e).display,o=("none"===n&&(n="block"),e.style.display=n,e.offsetHeight);e.style.height=0,e.style.overflow="hidden",requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.style.transition=`height ${t}ms ease`,e.style.height=o+"px"})}),setTimeout(()=>{e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition")},t)}function slideToggle(e,t=500){("none"===window.getComputedStyle(e).display?slideDown:slideUp)(e,t)}function getSiblings(t){var n=[];if(t.parentNode){let e=t.parentNode.firstChild;for(;e;)1===e.nodeType&&e!==t&&n.push(e),e=e.nextSibling}return n}function setTelMask(){[].forEach.call(document.querySelectorAll('[type="tel"]'),function(s){let l;function e(e){e.keyCode&&(l=e.keyCode),this.selectionStart<3&&e.preventDefault();let t=s.placeholder,n=0,o=t.replace(/\D/g,""),a=this.value.replace(/\D/g,""),r=t.replace(/[_\d]/g,function(e){return n<a.length?a.charAt(n++)||o.charAt(n):e});-1!=(n=r.indexOf("_"))&&(n<5&&(n=3),r=r.slice(0,n));var i=t.substr(0,this.value.length).replace(/_+/g,function(e){return"\\d{1,"+e.length+"}"}).replace(/[+()]/g,"\\$&");(!(i=new RegExp("^"+i+"$")).test(this.value)||this.value.length<5||47<l&&l<58)&&(this.value=r),"blur"==e.type&&this.value.length<5&&(this.value="")}s.addEventListener("input",e,!1),s.addEventListener("focus",e,!1),s.addEventListener("blur",e,!1),s.addEventListener("keydown",e,!1)})}function sendForms(){let r=Date.now(),i=[];document.querySelectorAll("input, textarea").forEach(e=>{let t=null;e.addEventListener("input",()=>{var e=Date.now();t&&i.push(e-t),t=e})}),document.querySelectorAll("form.js-form").forEach(function(a){a.addEventListener("submit",function(e){e.preventDefault();var e=new FormData(a),t=a.getAttribute("name");let n=a.querySelector("button[type=submit]"),o=n.innerHTML;t&&(e.append("form_name",t),e.append("time_on_page",Date.now()-r),e.append("typing_speed",JSON.stringify(i)),e.append("action","send_mail"),n.innerHTML="Отправляю...",a.classList.add("loading"),fetch(adem_ajax.url,{method:"POST",body:e}).then(e=>e.text()).then(e=>{Fancybox.close(!0),a.reset(),a.classList.remove("loading"),n.innerHTML=o,setTimeout(function(){Fancybox.show([{src:"#modal-success",type:"inline"}])},100)}).catch(e=>{console.error("Error:",e)}))})})}function initTabs(){let t={init:function(){this.bindUIfunctions()},bindUIfunctions:function(){$(".js-tabs").on("click","li:not(.active)",function(e){t.changeTab($(this))}),$(".js-tabs").on("click","li.active",function(e){t.toggleMobileMenu(e,this)})},changeTab:function(e){var t=$("#"+e.data("tab"));e.addClass("active").siblings().removeClass("active"),t.addClass("active").siblings().removeClass("active"),e.closest(".js-tabs").removeClass("open")},toggleMobileMenu:function(e,t){$(t).closest(".js-tabs").toggleClass("open")}};t.init()}function loadMorePosts(){var e=document.querySelector("#ajax_loader");e&&new IntersectionObserver(function(e,t){let n=document.querySelector("#ajax_loader");e[0].intersectionRatio&&(n.classList.add("loading"),catalog_current_page++,fetch(adem_ajax.url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:new URLSearchParams({action:"load_more",query:JSON.stringify(catalog_query),page:catalog_current_page,nonce:catalog_nonce})}).then(e=>e.text()).then(e=>{e&&$(".catalog__grid").append(e),n.classList.remove("loading")}).catch(e=>{console.error("Error:",e)}))},{root:null,rootMargin:"0px",threshold:.1}).observe(e)}function burgerToggle(){let t=document.querySelector(".js-burger-btn"),n=document.querySelector(".js-burger");t&&n&&t.addEventListener("click",function(e){t.classList.toggle("active"),n.classList.toggle("active")})}function initSidebarMenu(){$(".sidebar__menu > .menu-item").on("mouseenter",function(e){e.preventDefault(),$(this).siblings().find(".sub-menu").hide(),$(this).find(".sub-menu").fadeIn(),$(this).addClass("hover")}).on("mouseleave",function(){$(".sub-menu").hide(),$(this).removeClass("hover")})}function sendStatusForm(){let t=document.querySelector("#status"),n=document.querySelector(".status__container");t&&n&&t.addEventListener("submit",function(e){e.preventDefault();e=new FormData(t);e.append("action","status"),t.classList.add("loading"),fetch(adem_ajax.url,{method:"POST",body:e}).then(e=>e.text()).then(e=>{n.innerHTML=e}).catch(e=>{console.error("Error:",e)})})}function orderFromCatalogs(){let a=document.querySelector("form#order");var e=document.querySelector("#add_pos"),t=document.querySelector("#calc_order");let n=1;function o(){var e=document.querySelector(".order__table tr:last-child");let t=`<tr class="order__catalog-row" data-name="Позиция ${n}">
														<td data-name="Каталог">
															<select class="input order__input" name='cat_${n}'>`;adem_ajax.catalogs.forEach(function(e){t+=`<option value="${e.name}">${e.name}</option>`}),t+=`</select>
		</td>
		<td data-name="Стр.">
			<input class="input order__input" type='text' name='page_${n}'>
		</td>
		<td data-name="Рис.">
			<input class="input order__input" type='text' name='img_${n}'>
		</td>
		<td data-name="Название на русском">
			<input class="input order__input" type='text' name='name_${n}'>
		</td>
		<td data-name="Кол-во">
			<input class="input order__input" type='text' name='count_${n}'>
		</td>
		<td data-name="Артикул">
			<input class="input order__input" type='text' name='art_${n}'>
		</td>
		<td data-name="Размер">
			<input class="input order__input" type='text' name='size_${n}'>
		</td>
		<td data-name="Цвет">
			<input class="input order__input" type='text' name='color_${n}'>
		</td>
		<td data-name="Цена (EURO)">
			<input class="input order__input" type='text' name='price_${n}'>
		</td>
	</tr>`,e.insertAdjacentHTML("afterend",t),document.querySelector("input[name=catalog_count]").value=n,n++}a&&(o(),e.addEventListener("click",o),t.addEventListener("click",function(){var e=document.querySelectorAll(".order__catalog-row");let n=0;var t=document.querySelector("input[name=percent]").value;let o;e.forEach(function(e){var t=e.querySelector("input[name^=count_]").value,e=e.querySelector("input[name^=price_]").value;n+=t*e}),o=t?"Сумма заказа с учетом доставки "+(n+=n*t/100)+" EUR":"Сумма заказа без учета доставки "+n+" EUR",0<n&&(document.querySelector(".order__total-text").innerHTML=`<strong>${o}</strong>`)}),a.addEventListener("submit",function(e){e.preventDefault();var e=new FormData(a),t=a.getAttribute("name");let n=a.querySelector("button[type=submit]"),o=n.innerHTML;t&&(e.append("form_name",t),e.append("action","make_order"),n.innerHTML="Отправляю...",a.classList.add("loading"),fetch(adem_ajax.url,{method:"POST",body:e}).then(e=>e.text()).then(e=>{a.reset(),a.classList.remove("loading"),n.innerHTML=o,document.querySelector("#order-success strong").innerHTML=e,setTimeout(function(){Fancybox.show([{src:"#order-success",type:"inline"}])},100)}).catch(e=>{console.error("Error:",e)}))}))}document.addEventListener("DOMContentLoaded",function(){Fancybox.bind(),burgerToggle(),initSidebarMenu(),initTabs(),loadMorePosts(),orderFromCatalogs(),setTelMask(),sendForms(),sendStatusForm()});