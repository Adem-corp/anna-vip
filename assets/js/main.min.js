let $=jQuery.noConflict();function slideUp(e,t=400){e.style.height=e.offsetHeight+"px",e.style.boxSizing="border-box",e.style.overflow="hidden",requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.style.transition=`height ${t}ms ease`,e.style.height=0})}),setTimeout(()=>{e.style.display="none",e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition")},t)}function slideDown(e,t=400){e.style.removeProperty("display");let n=getComputedStyle(e).display,r=("none"===n&&(n="block"),e.style.display=n,e.offsetHeight);e.style.height=0,e.style.overflow="hidden",requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.style.transition=`height ${t}ms ease`,e.style.height=r+"px"})}),setTimeout(()=>{e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition")},t)}function slideToggle(e,t=500){("none"===window.getComputedStyle(e).display?slideDown:slideUp)(e,t)}function getSiblings(t){var n=[];if(t.parentNode){let e=t.parentNode.firstChild;for(;e;)1===e.nodeType&&e!==t&&n.push(e),e=e.nextSibling}return n}function setTelMask(){[].forEach.call(document.querySelectorAll('[type="tel"]'),function(s){let c;function e(e){e.keyCode&&(c=e.keyCode),this.selectionStart<3&&e.preventDefault();let t=s.placeholder,n=0,r=t.replace(/\D/g,""),o=this.value.replace(/\D/g,""),a=t.replace(/[_\d]/g,function(e){return n<o.length?o.charAt(n++)||r.charAt(n):e});-1!=(n=a.indexOf("_"))&&(n<5&&(n=3),a=a.slice(0,n));var i=t.substr(0,this.value.length).replace(/_+/g,function(e){return"\\d{1,"+e.length+"}"}).replace(/[+()]/g,"\\$&");(!(i=new RegExp("^"+i+"$")).test(this.value)||this.value.length<5||47<c&&c<58)&&(this.value=a),"blur"==e.type&&this.value.length<5&&(this.value="")}s.addEventListener("input",e,!1),s.addEventListener("focus",e,!1),s.addEventListener("blur",e,!1),s.addEventListener("keydown",e,!1)})}function sendForms(){let a=Date.now(),i=[];document.querySelectorAll("input, textarea").forEach(e=>{let t=null;e.addEventListener("input",()=>{var e=Date.now();t&&i.push(e-t),t=e})}),document.querySelectorAll("form.js-form").forEach(function(o){o.addEventListener("submit",function(e){e.preventDefault();var e=new FormData(o),t=o.getAttribute("name");let n=o.querySelector("button[type=submit]"),r=n.innerHTML;t&&(e.append("form_name",t),e.append("time_on_page",Date.now()-a),e.append("typing_speed",JSON.stringify(i)),e.append("action","send_mail"),n.innerHTML="Отправляю...",o.classList.add("loading"),fetch(adem_ajax.url,{method:"POST",body:e}).then(e=>e.text()).then(e=>{Fancybox.close(!0),o.reset(),o.classList.remove("loading"),n.innerHTML=r,setTimeout(function(){Fancybox.show([{src:"#modal-success",type:"inline"}])},100)}).catch(e=>{console.error("Error:",e)}))})})}function initTabs(){let t={init:function(){this.bindUIfunctions()},bindUIfunctions:function(){$(".js-tabs").on("click","li:not(.active)",function(e){t.changeTab($(this))}),$(".js-tabs").on("click","li.active",function(e){t.toggleMobileMenu(e,this)})},changeTab:function(e){var t=$("#"+e.data("tab"));e.addClass("active").siblings().removeClass("active"),t.addClass("active").siblings().removeClass("active"),e.closest(".js-tabs").removeClass("open")},toggleMobileMenu:function(e,t){$(t).closest(".js-tabs").toggleClass("open")}};t.init()}function loadMorePosts(){var e=document.querySelector("#ajax_loader");e&&new IntersectionObserver(function(e,t){let n=document.querySelector("#ajax_loader");e[0].intersectionRatio&&(n.classList.add("loading"),catalog_current_page++,fetch(adem_ajax.url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:new URLSearchParams({action:"load_more",query:JSON.stringify(catalog_query),page:catalog_current_page,nonce:catalog_nonce})}).then(e=>e.text()).then(e=>{e&&$(".catalog__grid").append(e),n.classList.remove("loading")}).catch(e=>{console.error("Error:",e)}))},{root:null,rootMargin:"0px",threshold:.1}).observe(e)}function burgerToggle(){let t=document.querySelector(".js-burger-btn"),n=document.querySelector(".js-burger");t&&n&&t.addEventListener("click",function(e){t.classList.toggle("active"),n.classList.toggle("active")})}function initSidebarMenu(){var e=document.querySelector(".sidebar");e&&e.addEventListener("click",function(e){e.target.closest('a[href="#"]')&&e.preventDefault()})}function sendStatusForm(){let t=document.querySelector("#status"),n=document.querySelector(".status__container");t&&n&&t.addEventListener("submit",function(e){e.preventDefault();e=new FormData(t);e.append("action","status"),t.classList.add("loading"),fetch(adem_ajax.url,{method:"POST",body:e}).then(e=>e.text()).then(e=>{n.innerHTML=e}).catch(e=>{console.error("Error:",e)})})}function orderFromCatalogs(){let o=document.querySelector("form#order");var e=document.querySelector("#add_pos"),t=document.querySelector("#calc_order");let n=1;function r(){var e=document.querySelector(".order__table tr:last-child");let t=`<tr class="order__catalog-row" data-name="Позиция ${n}">
														<td data-name="Каталог">
															<select class="input order__input" name='cat_${n}'>`;adem_ajax.catalogs.forEach(function(e){t+=`<option value="${e.name}">${e.name}</option>`}),t+=`</select>
		</td>
		<td data-name="Стр.">
			<input class="input order__input" type='text' name='page_${n}'>
		</td>
		<td data-name="Рис.">
			<input class="input order__input" type='text' name='img_${n}'>
		</td>
		<td data-name="Название на русском">
			<input class="input order__input" type='text' name='name_${n}'>
		</td>
		<td data-name="Кол-во">
			<input class="input order__input" type='text' name='count_${n}'>
		</td>
		<td data-name="Артикул">
			<input class="input order__input" type='text' name='art_${n}'>
		</td>
		<td data-name="Размер">
			<input class="input order__input" type='text' name='size_${n}'>
		</td>
		<td data-name="Цвет">
			<input class="input order__input" type='text' name='color_${n}'>
		</td>
		<td data-name="Цена (EURO)">
			<input class="input order__input" type='text' name='price_${n}'>
		</td>
	</tr>`,e.insertAdjacentHTML("afterend",t),document.querySelector("input[name=catalog_count]").value=n,n++}o&&(r(),e.addEventListener("click",r),t.addEventListener("click",function(){var e=document.querySelectorAll(".order__catalog-row");let n=0;var t=document.querySelector("input[name=percent]").value;let r;e.forEach(function(e){var t=e.querySelector("input[name^=count_]").value,e=e.querySelector("input[name^=price_]").value;n+=t*e}),r=t?"Сумма заказа с учетом доставки "+(n+=n*t/100)+" EUR":"Сумма заказа без учета доставки "+n+" EUR",0<n&&(document.querySelector(".order__total-text").innerHTML=`<strong>${r}</strong>`)}),o.addEventListener("submit",function(e){e.preventDefault();var e=new FormData(o),t=o.getAttribute("name");let n=o.querySelector("button[type=submit]"),r=n.innerHTML;t&&(e.append("form_name",t),e.append("action","make_order"),n.innerHTML="Отправляю...",o.classList.add("loading"),fetch(adem_ajax.url,{method:"POST",body:e}).then(e=>e.text()).then(e=>{o.reset(),o.classList.remove("loading"),n.innerHTML=r,document.querySelector("#order-success strong").innerHTML=e,setTimeout(function(){Fancybox.show([{src:"#order-success",type:"inline"}])},100)}).catch(e=>{console.error("Error:",e)}))}))}function initReviewsSlider(){var e=document.querySelector(".reviews");e&&(new Swiper(e.querySelector(".swiper"),{slidesPerView:1,spaceBetween:8,centerInsufficientSlides:!0,pagination:{el:e.querySelector(".swiper-pagination"),type:"bullets",clickable:!0},breakpoints:{769:{slidesPerView:2,spaceBetween:15},1025:{slidesPerView:3,spaceBetween:15},1281:{slidesPerView:3,spaceBetween:30}}}),e.querySelectorAll(".review-card").forEach((e,t)=>{var t="review-popup-"+t,n=document.createElement("div");n.id=t,n.style.display="none",n.innerHTML=e.outerHTML,document.body.appendChild(n),e.setAttribute("data-fancybox","reviews"),e.setAttribute("data-src","#"+t)}))}function initInfoSlider(){var e=document.querySelectorAll(".info");e&&e.forEach(function(e){new Swiper(e.querySelector(".swiper"),{slidesPerView:1,spaceBetween:30,centerInsufficientSlides:!0,navigation:{nextEl:e.querySelector(".arrow--next"),prevEl:e.querySelector(".arrow--prev")}})})}function showProductPopup(){var e=document.querySelector(".products");let t=document.querySelector("#modal-product");e&&e.addEventListener("click",function(e){e=e.target.closest(".js-show-product");fetch(adem_ajax.url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:new URLSearchParams({action:"show_product",id:e.dataset.id,nonce:adem_ajax.product_nonce})}).then(e=>e.text()).then(e=>{t.innerHTML=e,setTimeout(function(){Fancybox.show([{src:"#modal-product",type:"inline"}])},100)}).catch(e=>{console.error("Error:",e)})})}function changeQuantity(){let s=document.querySelector(".js-qty");s&&s.addEventListener("click",function(t){t=t.target.closest(".qty__btn");if(t){var n=s.querySelector(".input"),r=parseInt(n.min,10),o=parseInt(n.max,10),a=!isNaN(r),i=!isNaN(o);let e=parseInt(n.value,10)||0;t.classList.contains("qty__btn--plus")?e++:e--,a&&(e=Math.max(e,r)),i&&(e=Math.min(e,o)),n.value=e}})}document.addEventListener("DOMContentLoaded",function(){Fancybox.bind(),burgerToggle(),changeQuantity(),initInfoSlider(),initReviewsSlider(),initSidebarMenu(),initTabs(),loadMorePosts(),orderFromCatalogs(),setTelMask(),sendForms(),sendStatusForm(),showProductPopup()});