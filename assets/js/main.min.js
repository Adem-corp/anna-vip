let $=jQuery.noConflict();function slideUp(e,t=400){e.style.height=e.offsetHeight+"px",e.style.boxSizing="border-box",e.style.overflow="hidden",requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.style.transition=`height ${t}ms ease`,e.style.height=0})}),setTimeout(()=>{e.style.display="none",e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition")},t)}function slideDown(e,t=400){e.style.removeProperty("display");let n=getComputedStyle(e).display,o=("none"===n&&(n="block"),e.style.display=n,e.offsetHeight);e.style.height=0,e.style.overflow="hidden",requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.style.transition=`height ${t}ms ease`,e.style.height=o+"px"})}),setTimeout(()=>{e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition")},t)}function slideToggle(e,t=500){("none"===window.getComputedStyle(e).display?slideDown:slideUp)(e,t)}function getSiblings(t){var n=[];if(t.parentNode){let e=t.parentNode.firstChild;for(;e;)1===e.nodeType&&e!==t&&n.push(e),e=e.nextSibling}return n}function setTelMask(){[].forEach.call(document.querySelectorAll('[type="tel"]'),function(r){let l;function e(e){e.keyCode&&(l=e.keyCode),this.selectionStart<3&&e.preventDefault();let t=r.placeholder,n=0,o=t.replace(/\D/g,""),s=this.value.replace(/\D/g,""),i=t.replace(/[_\d]/g,function(e){return n<s.length?s.charAt(n++)||o.charAt(n):e});-1!=(n=i.indexOf("_"))&&(n<5&&(n=3),i=i.slice(0,n));var a=t.substr(0,this.value.length).replace(/_+/g,function(e){return"\\d{1,"+e.length+"}"}).replace(/[+()]/g,"\\$&");(!(a=new RegExp("^"+a+"$")).test(this.value)||this.value.length<5||47<l&&l<58)&&(this.value=i),"blur"==e.type&&this.value.length<5&&(this.value="")}r.addEventListener("input",e,!1),r.addEventListener("focus",e,!1),r.addEventListener("blur",e,!1),r.addEventListener("keydown",e,!1)})}function sendForms(){let i=Date.now(),a=[];document.querySelectorAll("input, textarea").forEach(e=>{let t=null;e.addEventListener("input",()=>{var e=Date.now();t&&a.push(e-t),t=e})}),document.querySelectorAll("form.js-form").forEach(function(s){s.addEventListener("submit",function(e){e.preventDefault();var e=new FormData(s),t=s.getAttribute("name");let n=s.querySelector("button[type=submit]"),o=n.innerHTML;t&&(e.append("form_name",t),e.append("time_on_page",Date.now()-i),e.append("typing_speed",JSON.stringify(a)),e.append("action","send_mail"),n.innerHTML="Отправляю...",s.classList.add("loading"),fetch(adem_ajax.url,{method:"POST",body:e}).then(e=>e.text()).then(e=>{Fancybox.close(!0),s.reset(),s.classList.remove("loading"),n.innerHTML=o,setTimeout(function(){Fancybox.show([{src:"#modal-success",type:"inline"}])},100)}).catch(e=>{console.error("Error:",e)}))})})}function initTabs(){let t={init:function(){this.bindUIfunctions()},bindUIfunctions:function(){$(".js-tabs").on("click","li:not(.active)",function(e){t.changeTab($(this))}),$(".js-tabs").on("click","li.active",function(e){t.toggleMobileMenu(e,this)})},changeTab:function(e){var t=$("#"+e.data("tab"));e.addClass("active").siblings().removeClass("active"),t.addClass("active").siblings().removeClass("active"),e.closest(".js-tabs").removeClass("open")},toggleMobileMenu:function(e,t){$(t).closest(".js-tabs").toggleClass("open")}};t.init()}function loadMorePosts(){var e=document.querySelector("#ajax_loader");e&&new IntersectionObserver(function(e,t){let n=document.querySelector("#ajax_loader");e[0].intersectionRatio&&(n.classList.add("loading"),current_page++,$.ajax({url:adem_ajax.url,data:{action:"load_more",page:current_page,query:JSON.stringify(query)},type:"POST",success:function(e){e&&$(".page__grid").append(e)},complete:function(){n.classList.remove("loading")}}))},{root:null,rootMargin:"0px",threshold:.1}).observe(e)}function burgerToggle(){$(".js-burger").on("click",function(){$(".menu-container").fadeToggle()})}function initSidebarMenu(){$(".sidebar__menu > .menu-item").on("mouseenter",function(e){e.preventDefault(),$(this).siblings().find(".sub-menu").hide(),$(this).find(".sub-menu").fadeIn(),$(this).addClass("hover")}).on("mouseleave",function(){$(".sub-menu").hide(),$(this).removeClass("hover")})}function sendSubscribeForm(){$("form#subscribe").on("submit",function(e){e.preventDefault();let t=$(this);e=new FormData(t.get(0));t.data("name")&&(e.append("form_name",t.data("name")),$.ajax({type:"POST",url:"/wp-admin/admin-ajax.php?action=subscribe",data:e,cache:!1,processData:!1,contentType:!1,success:function(e){$.fancybox.close(),t.trigger("reset"),setTimeout(function(){$.fancybox.open({src:'<div class="success" id="order_success"><svg class="success__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="success__icon-circle" cx="26" cy="26" r="25" fill="none" /><path class="success__icon-check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8" /></svg><h3>Спасибо</h3><p>Вы подписаны на рассылку новостей.</p><button class="btn btn_success" type="button" data-fancybox-close>OK</button></div>',type:"inline",modal:!0})},100)},error:function(e,t,n){console.log(e,t,n)}}))})}function sendStatusForm(){$("form#status").on("submit",function(e){e.preventDefault();e=$(this),e=new FormData(e.get(0));$.ajax({type:"POST",url:"/wp-admin/admin-ajax.php?action=status",data:e,cache:!1,processData:!1,contentType:!1,success:function(e){$(".status").html(e)},error:function(e,t,n){console.log(e,t,n)}})})}document.addEventListener("DOMContentLoaded",function(){Fancybox.bind(),burgerToggle(),initSidebarMenu(),initTabs(),loadMorePosts(),setTelMask(),sendForms(),sendStatusForm(),sendSubscribeForm()});